{"ast":null,"code":"import _classCallCheck from \"/Users/lap12548/Documents/hcmus/TOTNGHIEP/GITHUB/FrondEnd/Tidi_FE/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"/Users/lap12548/Documents/hcmus/TOTNGHIEP/GITHUB/FrondEnd/Tidi_FE/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/lap12548/Documents/hcmus/TOTNGHIEP/GITHUB/FrondEnd/Tidi_FE/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/lap12548/Documents/hcmus/TOTNGHIEP/GITHUB/FrondEnd/Tidi_FE/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/lap12548/Documents/hcmus/TOTNGHIEP/GITHUB/FrondEnd/Tidi_FE/src/routes/RouteWithSubRoutes.jsx\";\n// StyleSheets\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport AuthService from \"../services/AuthService\";\nimport { Route } from \"react-router-dom\";\nimport \"./RouteWithSubRoutes.scss\";\nimport { USER_TYPE } from \"../config/constants\";\nimport Loader from \"../pages/common/Loader/Loader\";\nvar INTIIAL_STATE = {\n  tokenVerificationCompleted: false,\n  isLoggedIn: false,\n  permission: null,\n  username: null\n};\n\nvar HOC =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(HOC, _Component);\n\n  function HOC(props) {\n    var _this2 = this;\n\n    var _this;\n\n    _classCallCheck(this, HOC);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(HOC).call(this, props));\n\n    _this.componentDidMount = function () {\n      AuthService.isLoggedIn().then(function (res) {\n        var newState = {};\n        newState.tokenVerificationCompleted = true;\n\n        if (res.tokenIsValid) {\n          newState.isLoggedIn = true;\n          newState.username = res.username;\n          newState.permission = res.permission;\n        }\n\n        newState.isVerified = res.emailIsVerified;\n\n        _this.setState(newState);\n      });\n      window.scrollTo(0, 0);\n    };\n\n    _this.render = function () {\n      var _this$state = _this.state,\n          tokenVerificationCompleted = _this$state.tokenVerificationCompleted,\n          permission = _this$state.permission;\n      var requiredPermission = _this.props.requiredPermission;\n\n      if (tokenVerificationCompleted) {\n        if (requiredPermission === USER_TYPE.PUBLIC || permission === USER_TYPE.ADMIN || requiredPermission === permission) {\n          return React.createElement(_this2.props.component, Object.assign({}, _this.props, _this.state, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 50\n            },\n            __self: this\n          }));\n        } else {\n          return React.createElement(\"div\", {\n            className: \"d-flex justify-content-center align-items-center p5\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 53\n            },\n            __self: this\n          }, \"You don't have permission to access this page\");\n        }\n      }\n\n      return React.createElement(Loader, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57\n        },\n        __self: this\n      });\n    };\n\n    _this.state = INTIIAL_STATE;\n    return _this;\n  }\n\n  return HOC;\n}(Component);\n\nHOC.propTypes = {\n  requiredPermission: PropTypes.oneOf([USER_TYPE.ADMIN, USER_TYPE.CUSTOMER, USER_TYPE.PUBLIC]),\n  permission: PropTypes.oneOf([USER_TYPE.ADMIN, USER_TYPE.CUSTOMER, USER_TYPE.PUBLIC]),\n  component: PropTypes.oneOfType([PropTypes.func, PropTypes.element])\n};\nexport default (function (route) {\n  return React.createElement(Route, {\n    exact: route.exact,\n    path: route.path,\n    render: function render(props) {\n      return React.createElement(HOC, Object.assign({\n        requiredPermission: route.permission,\n        component: route.component,\n        routes: route.routes\n      }, props, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65\n        },\n        __self: this\n      }));\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  });\n});","map":{"version":3,"sources":["/Users/lap12548/Documents/hcmus/TOTNGHIEP/GITHUB/FrondEnd/Tidi_FE/src/routes/RouteWithSubRoutes.jsx"],"names":["React","Component","PropTypes","AuthService","Route","USER_TYPE","Loader","INTIIAL_STATE","tokenVerificationCompleted","isLoggedIn","permission","username","HOC","props","componentDidMount","then","res","newState","tokenIsValid","isVerified","emailIsVerified","setState","window","scrollTo","render","state","requiredPermission","PUBLIC","ADMIN","propTypes","oneOf","CUSTOMER","component","oneOfType","func","element","route","exact","path","routes"],"mappings":"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","sourcesContent":["// StyleSheets\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport AuthService from \"../services/AuthService\";\nimport { Route } from \"react-router-dom\";\nimport \"./RouteWithSubRoutes.scss\";\nimport { USER_TYPE } from \"../config/constants\";\nimport Loader from \"../pages/common/Loader/Loader\";\n\nconst INTIIAL_STATE = {\n    tokenVerificationCompleted: false,\n    isLoggedIn: false,\n    permission: null,\n    username: null\n};\n\nclass HOC extends Component {\n    static propTypes = {\n        requiredPermission: PropTypes.oneOf([USER_TYPE.ADMIN, USER_TYPE.CUSTOMER, USER_TYPE.PUBLIC]),\n        permission: PropTypes.oneOf([USER_TYPE.ADMIN, USER_TYPE.CUSTOMER, USER_TYPE.PUBLIC]),\n        component: PropTypes.oneOfType([PropTypes.func, PropTypes.element])\n    };\n\n    constructor(props: any) {\n        super(props);\n        this.state = INTIIAL_STATE;\n    }\n\n    componentDidMount = () => {\n        AuthService.isLoggedIn().then(res => {\n            let newState = {};\n            newState.tokenVerificationCompleted = true;\n            if (res.tokenIsValid) {\n                newState.isLoggedIn = true;\n                newState.username = res.username;\n                newState.permission = res.permission;\n            }\n            newState.isVerified = res.emailIsVerified;\n\n            this.setState(newState);\n        });\n        window.scrollTo(0, 0);\n    };\n\n    render = () => {\n        const { tokenVerificationCompleted, permission } = this.state;\n        const { requiredPermission } = this.props;\n        if (tokenVerificationCompleted) {\n            if (requiredPermission === USER_TYPE.PUBLIC || permission === USER_TYPE.ADMIN || requiredPermission === permission) {\n                return <this.props.component {...this.props} {...this.state} />;\n            } else {\n                return (\n                    <div className=\"d-flex justify-content-center align-items-center p5\">You don't have permission to access this page</div>\n                );\n            }\n        }\n        return <Loader />;\n    };\n}\n\nexport default route => (\n    <Route\n        exact={route.exact}\n        path={route.path}\n        render={props => <HOC requiredPermission={route.permission} component={route.component} routes={route.routes} {...props} />}\n    />\n);\n"]},"metadata":{},"sourceType":"module"}