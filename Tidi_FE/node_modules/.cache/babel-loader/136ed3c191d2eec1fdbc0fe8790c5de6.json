{"ast":null,"code":"import _classCallCheck from \"/Users/lap12548/Documents/hcmus/TOTNGHIEP/GITHUB/FrondEnd/Tidi_FE/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"/Users/lap12548/Documents/hcmus/TOTNGHIEP/GITHUB/FrondEnd/Tidi_FE/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/lap12548/Documents/hcmus/TOTNGHIEP/GITHUB/FrondEnd/Tidi_FE/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/lap12548/Documents/hcmus/TOTNGHIEP/GITHUB/FrondEnd/Tidi_FE/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/lap12548/Documents/hcmus/TOTNGHIEP/GITHUB/FrondEnd/Tidi_FE/src/pages/common/Cart/Cart.jsx\";\nimport React, { Component } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport PropTypes from \"prop-types\";\nimport \"./Cart.scss\";\nimport { ROUTE_NAME } from \"../../../routes/main.routing\";\nimport { withCommas, showAlert } from \"../../../helpers/lib\";\nimport WebService from \"../../../services/WebService\";\nimport AuthService from \"../../../services/AuthService\";\nimport { ACTIVE_TYPE } from \"../../../config/constants\";\nvar INTERNAL_CONFIG = {\n  AMOUNT_UPATE_DELAY_DURATION: 300\n};\n\nvar Cart =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Cart, _Component);\n\n  function Cart(props) {\n    var _this;\n\n    _classCallCheck(this, Cart);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Cart).call(this, props));\n\n    _this.componentDidMount = function () {\n      _this.fetchCartProducts();\n    };\n\n    _this.fetchCartProducts = function () {\n      var _this$props = _this.props,\n          isLoggedIn = _this$props.isLoggedIn,\n          changeLoginStatus = _this$props.changeLoginStatus;\n\n      if (isLoggedIn) {\n        AuthService.verifyToken(changeLoginStatus);\n        WebService.getCart(AuthService.getTokenUnsafe()).then(function (res) {\n          var result = JSON.parse(res);\n\n          if (result.status && result.status === true) {\n            if (result.products) {\n              result.products.forEach(function (prd) {\n                prd.images = JSON.parse(prd.images);\n              });\n            }\n\n            _this.props.updateCartProducts(result.products);\n          }\n        });\n      }\n    };\n\n    _this.handleProductRemove = function (product) {\n      if (product.id) {\n        WebService.deleteItemFromCart(AuthService.getTokenUnsafe(), product.id).then(function (r) {\n          console.log(r);\n          var res = JSON.parse(r);\n\n          if (res.code === 200) {\n            showAlert(\"Removed \".concat(product.product_name));\n\n            _this.fetchCartProducts();\n          }\n        });\n      }\n    };\n\n    _this.handleProductAmountChange = function (cartItem, amount) {\n      if (cartItem.id && cartItem.amount + amount > 0) {\n        cartItem.amount += amount;\n\n        if (_this.amountDelayTimeout) {\n          clearTimeout(_this.amountDelayTimeout);\n        }\n\n        _this.amountDelayTimeout = setTimeout(function () {\n          WebService.updateItemInCart(AuthService.getTokenUnsafe(), cartItem.id, cartItem.amount).then(function (r) {\n            var res = JSON.parse(r);\n\n            if (res.status === ACTIVE_TYPE.TRUE) {\n              console.log(\"Updated amount\");\n            }\n          });\n        }, INTERNAL_CONFIG.AMOUNT_UPATE_DELAY_DURATION);\n      }\n    };\n\n    _this.generateProductBoxes = function () {\n      var R = [];\n      var _this$props2 = _this.props,\n          products = _this$props2.products,\n          toggleCart = _this$props2.toggleCart;\n\n      if (products) {\n        products.forEach(function (cartItem, index) {\n          var discountedPrice = cartItem.price - cartItem.price * cartItem.discPercent;\n          R.push(React.createElement(\"div\", {\n            key: index,\n            className: \"single-cart-item\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 92\n            },\n            __self: this\n          }, React.createElement(\"span\", {\n            className: \"product-remove\",\n            onClick: function onClick() {\n              return _this.handleProductRemove(cartItem);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 93\n            },\n            __self: this\n          }, React.createElement(\"i\", {\n            className: \"fa fa-close\",\n            \"aria-hidden\": \"true\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 94\n            },\n            __self: this\n          })), React.createElement(Link, {\n            replace: true,\n            to: {\n              pathname: ROUTE_NAME.PRODUCT_DETAIL + \"/\" + cartItem.id,\n              search: \"\"\n            },\n            className: \"product-image\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 96\n            },\n            __self: this\n          }, React.createElement(\"img\", {\n            src: cartItem.images[0],\n            className: \"cart-thumb\",\n            alt: \"\",\n            onClick: function onClick() {\n              toggleCart(false);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 104\n            },\n            __self: this\n          }), React.createElement(\"div\", {\n            className: \"cart-item-desc\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 113\n            },\n            __self: this\n          }, React.createElement(\"span\", {\n            className: \"badge\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 114\n            },\n            __self: this\n          }, cartItem.category.category_name), React.createElement(\"h6\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 115\n            },\n            __self: this\n          }, cartItem.product_name), React.createElement(\"div\", {\n            className: \"cart-item-quantity d-flex align-items-center justify-content-between\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 116\n            },\n            __self: this\n          }, React.createElement(\"button\", {\n            className: \"btn btn-danger btn-sm\",\n            onClick: function onClick() {\n              return _this.handleProductAmountChange(cartItem, -1);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 117\n            },\n            __self: this\n          }, \"-\"), React.createElement(\"span\", {\n            className: \"badge item-quantity\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 120\n            },\n            __self: this\n          }, \"\".concat(cartItem.amount)), React.createElement(\"button\", {\n            className: \"btn btn-success btn-sm\",\n            onClick: function onClick() {\n              return _this.handleProductAmountChange(cartItem, 1);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 121\n            },\n            __self: this\n          }, \"+\")), React.createElement(\"p\", {\n            className: \"price\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 125\n            },\n            __self: this\n          }, withCommas(Math.round(discountedPrice * cartItem.amount)) + \" ₫\")))));\n        });\n      }\n\n      return R;\n    };\n\n    _this.generateCartItemNames = function () {\n      var R = [];\n      var total = 0;\n      var products = _this.props.products;\n\n      if (products) {\n        products.forEach(function (cartItem, index) {\n          var itemPrice = (cartItem.price - cartItem.price * cartItem.discPercent) * cartItem.amount;\n          R.push(React.createElement(\"li\", {\n            key: index,\n            className: \"cart-item-name\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 145\n            },\n            __self: this\n          }, cartItem.product_name, \" x \", cartItem.amount, React.createElement(\"span\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 147\n            },\n            __self: this\n          }), React.createElement(\"span\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 148\n            },\n            __self: this\n          }, withCommas(Math.round(itemPrice)), \" \\u20AB\")));\n          total += itemPrice;\n        });\n      }\n\n      _this.total = total;\n      return R;\n    };\n\n    _this.render = function () {\n      var _this$props3 = _this.props,\n          isActive = _this$props3.isActive,\n          toggleCart = _this$props3.toggleCart,\n          products = _this$props3.products;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"cart-bg-overlay \" + (isActive ? \"cart-bg-overlay-on\" : \"\"),\n        onClick: function onClick() {\n          toggleCart(false);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"right-side-cart-area \" + (isActive ? \"cart-on\" : \"\"),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"cart-button\",\n        onClick: function onClick() {\n          toggleCart(false);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        id: \"rightSideCart\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: \"/img/core-img/cancel.svg\",\n        alt: \"Close\",\n        draggable: \"false\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        className: \"cart-content d-flex\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, (!products || products.length === 0) && React.createElement(\"div\", {\n        className: \"empty-cart\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: \"/img/core-img/emptycart.png\",\n        alt: \"\",\n        draggable: \"false\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190\n        },\n        __self: this\n      }), React.createElement(\"h2\", {\n        className: \"text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, \"Your cart is empty!\")), products && products.length > 0 && React.createElement(\"div\", {\n        className: \"cart-list\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }, _this.generateProductBoxes()), _this.props.products && _this.props.products.length > 0 && React.createElement(\"div\", {\n        className: \"cart-amount-summary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, \"Summary\"), React.createElement(\"ul\", {\n        className: \"summary-table\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, _this.generateCartItemNames(), React.createElement(\"li\", {\n        className: \"summary-header\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, \"total:\"), \" \", React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, withCommas(Math.round(_this.total)), \" \\u20AB\"))), React.createElement(\"div\", {\n        className: \"checkout-btn mt-100\",\n        onClick: function onClick() {\n          _this.props.toggleCart(false);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208\n        },\n        __self: this\n      }, React.createElement(Link, {\n        to: ROUTE_NAME.CHECKOUT,\n        className: \"btn essence-btn\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214\n        },\n        __self: this\n      }, \"check out\"))))));\n    };\n\n    _this.total = 0;\n    _this.amountDelayTimeout = null;\n    return _this;\n  }\n\n  return Cart;\n}(Component);\n\nCart.propTypes = {\n  toggleCart: PropTypes.func,\n  updateCartProducts: PropTypes.func,\n  isLoggedIn: PropTypes.bool,\n  products: PropTypes.array\n};\nexport default Cart;","map":{"version":3,"sources":["/Users/lap12548/Documents/hcmus/TOTNGHIEP/GITHUB/FrondEnd/Tidi_FE/src/pages/common/Cart/Cart.jsx"],"names":["React","Component","Link","PropTypes","ROUTE_NAME","withCommas","showAlert","WebService","AuthService","ACTIVE_TYPE","INTERNAL_CONFIG","AMOUNT_UPATE_DELAY_DURATION","Cart","props","componentDidMount","fetchCartProducts","isLoggedIn","changeLoginStatus","verifyToken","getCart","getTokenUnsafe","then","res","result","JSON","parse","status","products","forEach","prd","images","updateCartProducts","handleProductRemove","product","id","deleteItemFromCart","r","console","log","code","product_name","handleProductAmountChange","cartItem","amount","amountDelayTimeout","clearTimeout","setTimeout","updateItemInCart","TRUE","generateProductBoxes","R","toggleCart","index","discountedPrice","price","discPercent","push","pathname","PRODUCT_DETAIL","search","category","category_name","Math","round","generateCartItemNames","total","itemPrice","render","isActive","length","CHECKOUT","propTypes","func","bool","array"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport PropTypes from \"prop-types\";\nimport \"./Cart.scss\";\nimport { ROUTE_NAME } from \"../../../routes/main.routing\";\nimport { withCommas, showAlert } from \"../../../helpers/lib\";\nimport WebService from \"../../../services/WebService\";\nimport AuthService from \"../../../services/AuthService\";\nimport { ACTIVE_TYPE } from \"../../../config/constants\";\n\nconst INTERNAL_CONFIG = {\n    AMOUNT_UPATE_DELAY_DURATION: 300\n};\n\nclass Cart extends Component {\n    static propTypes = {\n        toggleCart: PropTypes.func,\n        updateCartProducts: PropTypes.func,\n        isLoggedIn: PropTypes.bool,\n        products: PropTypes.array\n    };\n\n    constructor(props) {\n        super(props);\n        this.total = 0;\n        this.amountDelayTimeout = null;\n    }\n\n    componentDidMount = () => {\n        this.fetchCartProducts();\n    };\n\n    fetchCartProducts = () => {\n        const { isLoggedIn, changeLoginStatus } = this.props;\n        if (isLoggedIn) {\n            AuthService.verifyToken(changeLoginStatus);\n            WebService.getCart(AuthService.getTokenUnsafe()).then(res => {\n                const result = JSON.parse(res);\n                if (result.status && result.status === true) {\n                    if (result.products) {\n                        result.products.forEach(prd => {\n                            prd.images = JSON.parse(prd.images);\n                        });\n                    }\n                    this.props.updateCartProducts(result.products);\n                }\n            });\n        }\n    };\n\n    handleProductRemove = product => {\n        if (product.id) {\n            WebService.deleteItemFromCart(AuthService.getTokenUnsafe(), product.id).then(r => {\n                console.log(r);\n                const res = JSON.parse(r);\n\n                if (res.code === 200) {\n                    showAlert(`Removed ${product.product_name}`);\n                    this.fetchCartProducts();\n                }\n            });\n        }\n    };\n\n    handleProductAmountChange = (cartItem, amount) => {\n        if (cartItem.id && cartItem.amount + amount > 0) {\n            cartItem.amount += amount;\n\n            if (this.amountDelayTimeout) {\n                clearTimeout(this.amountDelayTimeout);\n            }\n            this.amountDelayTimeout = setTimeout(() => {\n                WebService.updateItemInCart(AuthService.getTokenUnsafe(), cartItem.id, cartItem.amount).then(r => {\n                    const res = JSON.parse(r);\n\n                    if (res.status === ACTIVE_TYPE.TRUE) {\n                        console.log(\"Updated amount\");\n                    }\n                });\n            }, INTERNAL_CONFIG.AMOUNT_UPATE_DELAY_DURATION);\n        }\n    };\n\n    generateProductBoxes = () => {\n        let R = [];\n        const { products, toggleCart } = this.props;\n        if (products) {\n            products.forEach((cartItem, index) => {\n                const discountedPrice = cartItem.price - cartItem.price * cartItem.discPercent;\n\n                R.push(\n                    <div key={index} className=\"single-cart-item\">\n                        <span className=\"product-remove\" onClick={() => this.handleProductRemove(cartItem)}>\n                            <i className=\"fa fa-close\" aria-hidden=\"true\" />\n                        </span>\n                        <Link\n                            replace\n                            to={{\n                                pathname: ROUTE_NAME.PRODUCT_DETAIL + \"/\" + cartItem.id,\n                                search: \"\"\n                            }}\n                            className=\"product-image\"\n                        >\n                            <img\n                                src={cartItem.images[0]}\n                                className=\"cart-thumb\"\n                                alt=\"\"\n                                onClick={() => {\n                                    toggleCart(false);\n                                }}\n                            />\n                            {/* <!-- Cart Item Desc --> */}\n                            <div className=\"cart-item-desc\">\n                                <span className=\"badge\">{cartItem.category.category_name}</span>\n                                <h6>{cartItem.product_name}</h6>\n                                <div className=\"cart-item-quantity d-flex align-items-center justify-content-between\">\n                                    <button className=\"btn btn-danger btn-sm\" onClick={() => this.handleProductAmountChange(cartItem, -1)}>\n                                        -\n                                    </button>\n                                    <span className=\"badge item-quantity\">{`${cartItem.amount}`}</span>\n                                    <button className=\"btn btn-success btn-sm\" onClick={() => this.handleProductAmountChange(cartItem, 1)}>\n                                        +\n                                    </button>\n                                </div>\n                                <p className=\"price\">{withCommas(Math.round(discountedPrice * cartItem.amount)) + \" ₫\"}</p>\n                            </div>\n                        </Link>\n                    </div>\n                );\n            });\n        }\n\n        return R;\n    };\n\n    generateCartItemNames = () => {\n        let R = [];\n        let total = 0;\n        const { products } = this.props;\n        if (products) {\n            products.forEach((cartItem, index) => {\n                let itemPrice = (cartItem.price - cartItem.price * cartItem.discPercent) * cartItem.amount;\n\n                R.push(\n                    <li key={index} className=\"cart-item-name\">\n                        {cartItem.product_name} x {cartItem.amount}\n                        <span />\n                        <span>{withCommas(Math.round(itemPrice))} ₫</span>\n                    </li>\n                );\n\n                total += itemPrice;\n            });\n        }\n\n        this.total = total;\n\n        return R;\n    };\n\n    render = () => {\n        const { isActive, toggleCart, products } = this.props;\n        return (\n            <div>\n                {/* <!-- ##### Right Side Cart Area ##### --> */}\n                <div\n                    className={\"cart-bg-overlay \" + (isActive ? \"cart-bg-overlay-on\" : \"\")}\n                    onClick={() => {\n                        toggleCart(false);\n                    }}\n                />\n\n                <div className={\"right-side-cart-area \" + (isActive ? \"cart-on\" : \"\")}>\n                    {/* <!-- Cart Button --> */}\n                    <div\n                        className=\"cart-button\"\n                        onClick={() => {\n                            toggleCart(false);\n                        }}\n                    >\n                        <div id=\"rightSideCart\">\n                            <img src=\"/img/core-img/cancel.svg\" alt=\"Close\" draggable=\"false\" />\n                        </div>\n                    </div>\n\n                    <div className=\"cart-content d-flex\">\n                        {/* EMPTY CART ICON */}\n                        {(!products || products.length === 0) && (\n                            <div className=\"empty-cart\">\n                                <img src=\"/img/core-img/emptycart.png\" alt=\"\" draggable=\"false\" />\n                                <h2 className=\"text-center\">Your cart is empty!</h2>\n                            </div>\n                        )}\n\n                        {/* <!-- Cart List Area --> */}\n                        {products && products.length > 0 && <div className=\"cart-list\">{this.generateProductBoxes()}</div>}\n\n                        {/* <!-- Cart Summary --> */}\n                        {this.props.products && this.props.products.length > 0 && (\n                            <div className=\"cart-amount-summary\">\n                                <h2>Summary</h2>\n                                <ul className=\"summary-table\">\n                                    {this.generateCartItemNames()}\n                                    <li className=\"summary-header\">\n                                        <span>total:</span> <span>{withCommas(Math.round(this.total))} ₫</span>\n                                    </li>\n                                </ul>\n                                <div\n                                    className=\"checkout-btn mt-100\"\n                                    onClick={() => {\n                                        this.props.toggleCart(false);\n                                    }}\n                                >\n                                    <Link to={ROUTE_NAME.CHECKOUT} className=\"btn essence-btn\">\n                                        check out\n                                    </Link>\n                                </div>\n                            </div>\n                        )}\n                    </div>\n                </div>\n                {/* <!-- ##### Right Side Cart End ##### --> */}\n            </div>\n        );\n    };\n}\n\nexport default Cart;\n"]},"metadata":{},"sourceType":"module"}